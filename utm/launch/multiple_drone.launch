<launch>

    <!--args for gcs bridge for communication with QGC on Windows OS-->
    <!--https://github.com/mavlink/mavros/issues/574-->
    <arg name="mavlink_bridge_url" default="udp://@172.20.112.1:14550" />

	<!--args for airsim_node.launch, set arg host to WSL2 ipaddress config-->
	<arg name="output" default="screen"/>
	<arg name="publish_clock" default="true"/>
	<arg name="is_vulkan" default="true"/>
	<arg name="host" default="172.20.112.1" />

	<!--Launch Airsim Node-->
	<include file="$(find airsim_ros_pkgs)/launch/airsim_node.launch">
		<arg name="output" value="screen"/>
		<arg name="publish_clock" value="true"/>
		<arg name="is_vulkan" value="true"/>
		<arg name="host" value="172.20.112.1" />	
	</include>

    <node pkg="mavros" type="gcs_bridge" name="mavlink_bridge">
        <param name="gcs_url" value="$(arg mavlink_bridge_url)" />
    </node>

    <group ns="uav0">
        <arg name="fcu_url" default="udp://:14540@172.20.112.1:14557" />
        <arg name="gcs_url" default="udp://:14556@172.20.112.1:14551" />
        <arg name="tgt_system" default="1" />
        <arg name="tgt_component" default="1" />
        <include file="$(find utm)/launch/mavros_gcs_launch.launch">
            <arg name="fcu_url" value="$(arg fcu_url)" />
            <arg name="gcs_url" value="$(arg gcs_url)"/>
            <arg name="tgt_system" value="$(arg tgt_system)" />
            <arg name="tgt_component" value="$(arg tgt_component)"/>
        </include>
    </group>

    <group ns="uav1">
        <arg name="fcu_url" default="udp://:14541@172.20.112.1:14558" />
        <arg name="gcs_url" default="udp://:14556@172.20.112.1:14551" />
        <arg name="tgt_system" default="2" />
        <arg name="tgt_component" default="1" />
        <include file="$(find utm)/launch/mavros_gcs_launch.launch">
            <arg name="fcu_url" value="$(arg fcu_url)" />
            <arg name="gcs_url" value="$(arg gcs_url)"/>
            <arg name="tgt_system" value="$(arg tgt_system)" />
            <arg name="tgt_component" value="$(arg tgt_component)"/>
        </include>
    </group>


</launch>
